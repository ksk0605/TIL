# íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ ì‹¤ì œ ì¿¼ë¦¬ë¡œ ì´í•´í•˜ê¸° 

## íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ 
- READ UNCOMMITTED : ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ì»¤ë°‹ë˜ì§€ ì•Šì€ ì‚¬í•­ì„ ì½ì„ ìˆ˜ ìˆë‹¤. (Dirty Read ë°œìƒ ê°€ëŠ¥)
- READ COMMITTED : ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ì»¤ë°‹ëœ ì‚¬í•­ë§Œ ì½ì„ ìˆ˜ ìˆë‹¤. (Non-Repeatable Read ë°œìƒ ê°€ëŠ¥)
- REPEATABLE READ : íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë™ì¼í•œ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ë²ˆ ì½ì„ ë•Œ ì¼ê´€ëœ ê²°ê³¼ë¥¼ ë³´ì¥í•œë‹¤. (Phantom Read ë°œìƒ ê°€ëŠ¥)
- SERIALIZABLE : ê°€ì¥ ì—„ê²©í•œ ê²©ë¦¬ ìˆ˜ì¤€ìœ¼ë¡œ, íŠ¸ëœì­ì…˜ë“¤ì´ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•œë‹¤.

## íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ë³„ ë¬¸ì œì ë“¤
- Dirty Read: ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ì»¤ë°‹ë˜ì§€ ì•Šì€ ë³€ê²½ ì‚¬í•­ì„ ì½ëŠ” í˜„ìƒ
- Non-Repeatable Read: ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ ì»¤ë°‹ëœ ë³€ê²½ì‚¬í•­ìœ¼ë¡œ ì¸í•´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì—ì„œ ë‘ë²ˆì˜ ì½ê¸°ê°€ ì„œë¡œ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ” í˜„ìƒ
- Phantom Read: ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì˜ Insertë¡œ ì¸í•´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì—ì„œ ë‘ë²ˆì˜ ì½ê¸°ì— ë˜ ë‹¤ë¥¸ ë¡œìš°ê°€ ì¶”ê°€ë˜ëŠ” í˜„ìƒ. 

## ì‹¤ì œ ì¿¼ë¦¬ë¡œ ì‹¤í—˜í•˜ê¸°

### ì˜ˆì‹œ ë°ì´í„° ìƒì„±í•˜ê¸°

```sql
CREATE TABLE accounts (
    id INT PRIMARY KEY,
    name VARCHAR(20),
    balance INT
);

INSERT INTO isolation_test.accounts VALUES (1, 'Alice', 1000);
INSERT INTO isolation_test.accounts VALUES (2, 'Bob', 1000);
```
![](../images/account-init.png)

### Dirty Read
- READ Uncommitted ì—ì„œ ë°œìƒ 

```sql
-- tx1
USE isolation_test;

SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
START TRANSACTION;

UPDATE accounts SET balance = 0 WHERE id = 1;

-- ì´ ìƒíƒœë¡œ ì»¤ë°‹ ì—†ì´ ëŒ€ê¸°

-- tx2 ë‹¤ë¥¸ íƒ­ì—ì„œ ì§„í–‰
USE isolation_test;

SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
START TRANSACTION;

SELECT * FROM accounts WHERE id = 1;

-- balanceê°€ 0ìœ¼ë¡œ ë³´ì´ë©´ Dirty Read ë°œìƒí•œ ê²ƒ!
-- ì›ë˜ëŠ” 1000ì´ì—ˆìŒ
```

![](../images/dirty-read.png)

### Non-repeatable Read

```sql
-- tx1
USE isolation_test;

SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;
START TRANSACTION;

-- ì²« ë²ˆì§¸ ì¡°íšŒ
SELECT * FROM accounts WHERE id = 1;
-- ğŸ‘† balance = 1000 ì´ë¼ê³  ê°€ì •
```

![](../images/non-repeatable-1.png)

```sql
-- tx2
USE isolation_test;

SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;
START TRANSACTION;

UPDATE accounts SET balance = 2000 WHERE id = 1;
COMMIT;


SELECT * FROM accounts WHERE id = 1;
-- ğŸ‘‡ ê²°ê³¼ê°€ 2000ì´ë©´ Non-Repeatable Read ë°œìƒ

```

![](../images/non-repeatable-2.png)


### Phantom Read

```sql
-- tx1
USE isolation_test;

SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;
START TRANSACTION;

-- ì²« ë²ˆì§¸ SELECT
SELECT * FROM accounts WHERE balance >= 1000;
-- ğŸ‘† í˜„ì¬ Alice, Bob 2ëª… ì˜ˆìƒ
```

![](../images/phantom-1.png)

```sql
USE isolation_test;

SET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;
START TRANSACTION;

INSERT INTO accounts (id, name, balance) VALUES (3, 'Charlie', 1500);
COMMIT;

-- ì»¤ë°‹í›„ ê°™ì€ ì¡°ê±´ìœ¼ë¡œ ë‹¤ì‹œ ì¡°íšŒ
SELECT * FROM accounts WHERE balance >= 1000;
-- ê²°ê³¼ê°€ ê·¸ëŒ€ë¡œ 2ëª… â†’ Phantom Read ë°©ì§€ë¨
-- ê²°ê³¼ê°€ 3ëª… (Charlie ì¶”ê°€ë¨) â†’ Phantom Read ë°œìƒ

```
![](../images/phantom-2.png)


